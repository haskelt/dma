{{ JS_COPYRIGHT_NOTICE }}

import logger from '{{ SITE_PATH }}/js/logger.js';

class CSVReader {

    /**************************************************************************/

    read (file_object, callback) {

	this.callback = callback;
	Papa.parse(file_object, { complete: this.finishRead.bind(this), header: true });
	
    } // read
    
    /**************************************************************************/

    finishRead (results) {

	if(results.errors.length > 0){
	    for(let error of results.errors){
		logger.postMessage('ERROR', 'files', error.message + ' at row ' + error.row);
	    }
	    this.callback(null);
	} else {
	    logger.postMessage('TRACE', 'files', 'Successfully parsed CSV file');
	    this.callback(results.data);
	}
	
    } // 
    
    /**************************************************************************/
    
} // CSVReader

export default CSVReader;


