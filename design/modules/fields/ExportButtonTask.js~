{{ JS_COPYRIGHT_NOTICE }}

import logger from '{{ SITE_PATH }}/js/logger.js';
import Task from '{{ SITE_PATH }}/js/tasks/Task.js';
import xlsxUtilities from '{{SITE_PATH}}/js/files/xlsxUtilities.js';
import DataManager from '{{ SITE_PATH }}/js/data/DataManager.js';

class ExportButtonTask extends Task {
    
    /**************************************************************************/

    constructor (element) {

	super(element);
	this.button = element.querySelector('.fields__export-button--button');
	this.button.addEventListener('click', this.handleClick.bind(this));
	
    } // constructor
    
    /**************************************************************************/

    handleClick (e) {

	logger.postMessage('DEBUG', 'fields', 'Beginning export');

    } // handleChange

    /**************************************************************************/

    fileReadCallback (data) {

	if(data == null){
	    alert('Error while parsing the selected file; please verify that it is in the correct format.');
	    this.input.value = null;
	} else {
	    this.data = data;
	    this.parent.setChildStatus(this, 'complete');
	}
	
    } // fileReadCallback
    
    /**************************************************************************/

    wrapUp () {

	try {
	    DataManager.postData(this.id, this.data);
	    return true;
	}
	catch (error) {
	    this.input.value = null;
	    this.parent.setChildStatus(this, 'incomplete');
	    throw(error);
	}
	
    } // wrapUp
    
    /**************************************************************************/
    
} // SpreadsheetSelectorTask

export default SpreadsheetSelectorTask;
